[gd_scene load_steps=18 format=3 uid="uid://ccvfvlphlk2c4"]

[ext_resource type="Script" path="res://scripts/player/player.gd" id="1_2f8j2"]
[ext_resource type="Script" path="res://scripts/player/camera.gd" id="2_gljcx"]
[ext_resource type="Script" path="res://scripts/player/reticle.gd" id="4_rvq42"]
[ext_resource type="PackedScene" uid="uid://dtf5btrv5n6hk" path="res://assets/models/player/scene.gltf" id="6_abw4n"]
[ext_resource type="Shader" path="res://assets/shaders/postprocesing.gdshader" id="6_ijvbn"]
[ext_resource type="Script" path="res://scripts/player/power_up_manager.gd" id="6_r4lie"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_22rvi"]
animation = &"Pistol_FIRE"
use_custom_timeline = true
timeline_length = 0.3
stretch_time_scale = true
start_offset = 0.0
loop_mode = 0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_c3n2h"]
animation = &"Pistol_IDLE"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_dclb6"]
animation = &"Pistol_RELOAD"
use_custom_timeline = true
timeline_length = 1.6
stretch_time_scale = true
start_offset = 0.0
loop_mode = 0

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0x281"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tijl3"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"shoot"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_24k2x"]
xfade_time = 0.2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_4khpk"]
advance_mode = 2
advance_condition = &"reload"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_nmo8o"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_f4gc3"]
states/End/position = Vector2(1160, 185)
states/Pistol_FIRE/node = SubResource("AnimationNodeAnimation_22rvi")
states/Pistol_FIRE/position = Vector2(570, 90)
states/Pistol_IDLE/node = SubResource("AnimationNodeAnimation_c3n2h")
states/Pistol_IDLE/position = Vector2(247, 185)
states/Pistol_RELOAD/node = SubResource("AnimationNodeAnimation_dclb6")
states/Pistol_RELOAD/position = Vector2(570, 242)
states/Start/position = Vector2(71, 185)
transitions = ["Start", "Pistol_IDLE", SubResource("AnimationNodeStateMachineTransition_0x281"), "Pistol_IDLE", "Pistol_FIRE", SubResource("AnimationNodeStateMachineTransition_tijl3"), "Pistol_FIRE", "Pistol_IDLE", SubResource("AnimationNodeStateMachineTransition_24k2x"), "Pistol_IDLE", "Pistol_RELOAD", SubResource("AnimationNodeStateMachineTransition_4khpk"), "Pistol_RELOAD", "Pistol_IDLE", SubResource("AnimationNodeStateMachineTransition_nmo8o")]
graph_offset = Vector2(12, 34)

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_3rsb5"]
radius = 0.3
height = 1.8

[sub_resource type="ShaderMaterial" id="ShaderMaterial_cv6qa"]
shader = ExtResource("6_ijvbn")
shader_parameter/grain_amount = 0.05
shader_parameter/grain_size = 0.5
shader_parameter/effect_amount = 1.5
shader_parameter/mask_softness = 1.4
shader_parameter/mask_threshold = 0.6
shader_parameter/sort = 0.0

[node name="Player" type="CharacterBody3D" groups=["player"]]
collision_layer = 2
collision_mask = 5
script = ExtResource("1_2f8j2")
speed = 15.0
jump_height = 2.0
damage = 21.0
shoot_range = 101.0

[node name="PowerUpManager" type="Node3D" parent="."]
script = ExtResource("6_r4lie")

[node name="Camera" type="Camera3D" parent="."]
transform = Transform3D(-0.999986, 0.00523596, 8.74228e-08, 0.00523596, 0.999986, -1.57691e-16, -8.74216e-08, 4.57742e-10, -1, 0, 1.725, 0)
fov = 90.0
near = 0.001
script = ExtResource("2_gljcx")
max_tilt_angle = 3.0

[node name="ShootRayCast" type="RayCast3D" parent="Camera"]
collision_mask = 2
collide_with_areas = true
debug_shape_custom_color = Color(1, 0, 0, 1)
debug_shape_thickness = 1

[node name="Player" parent="Camera" instance=ExtResource("6_abw4n")]
transform = Transform3D(-0.499993, 0.00261798, -4.37108e-08, 0.00261798, 0.499993, 2.28871e-10, 4.37114e-08, -8.32667e-17, -0.5, -0.00487994, -0.931987, -0.225)

[node name="Skeleton3D" parent="Camera/Player/Sketchfab_model/e430f8f941c64cbea96a18e2036f08b4_fbx/Object_2/RootNode/Object_4" index="0"]
bones/2/rotation = Quaternion(-0.00324912, 0, 0, 0.999995)
bones/3/position = Vector3(-5.38376, 3.39436, -23.224)
bones/4/position = Vector3(-1.16792, -4.6649, 9.04451)
bones/4/rotation = Quaternion(0.553139, -0.315625, 0.0725299, 0.767566)
bones/5/position = Vector3(-0.0967064, -0.206411, 19.46)
bones/5/rotation = Quaternion(0.599086, 0.0157852, 0.000499719, 0.800529)
bones/6/position = Vector3(0.591736, -0.229699, 12.1049)
bones/6/rotation = Quaternion(-8.63972e-08, -5.498e-08, 0.316477, 0.9486)
bones/7/position = Vector3(1.05599, -0.409918, 21.6019)
bones/7/rotation = Quaternion(-0.377628, 0.221459, 0.228535, 0.869554)
bones/7/scale = Vector3(1, 1, 1)
bones/8/position = Vector3(-3.54798, -2.87844, 4.18529)
bones/8/rotation = Quaternion(-0.404073, 0.0585491, 0.832243, -0.375059)
bones/8/scale = Vector3(1, 1, 1)
bones/9/position = Vector3(0.906139, 0.911579, 2.05269)
bones/9/rotation = Quaternion(1.38044e-07, -0.0549502, 8.39457e-08, 0.998489)
bones/10/position = Vector3(-0.709152, -0.130939, 4.48516)
bones/10/rotation = Quaternion(-2.6978e-08, -0.256289, 3.85403e-09, 0.9666)
bones/11/position = Vector3(-1.77533, -2.66094, 11.3457)
bones/11/rotation = Quaternion(0.201358, -0.00946756, -0.698973, 0.68615)
bones/11/scale = Vector3(1, 1, 1)
bones/12/position = Vector3(0.251369, 0.105297, 3.98446)
bones/12/rotation = Quaternion(0.348782, -0.00623533, 0.00415692, 0.937174)
bones/12/scale = Vector3(1, 1, 1)
bones/13/position = Vector3(-0.0447121, 0.0614357, 3.0816)
bones/13/rotation = Quaternion(0.299803, -0.0104909, 0.00232769, 0.953941)
bones/13/scale = Vector3(1, 1, 1)
bones/14/position = Vector3(-1.38164, -0.292946, 10.584)
bones/14/rotation = Quaternion(0.22725, -0.26388, -0.685029, 0.639891)
bones/15/position = Vector3(0.000228882, 0.186825, 3.93564)
bones/15/rotation = Quaternion(0.481754, -5.73904e-08, 7.33321e-08, 0.876307)
bones/16/position = Vector3(-0.0430222, 0.057972, 3.6739)
bones/16/rotation = Quaternion(0.568562, -1.96987e-07, 2.51328e-07, 0.822641)
bones/17/rotation = Quaternion(0.133379, -0.262444, -0.636424, 0.71295)
bones/17/scale = Vector3(1, 1, 1)
bones/18/position = Vector3(-0.0611382, 0.237825, 4.51569)
bones/18/rotation = Quaternion(0.600421, -1.99148e-07, -2.14289e-07, 0.799684)
bones/19/position = Vector3(0.122787, 0.0801353, 3.11915)
bones/19/rotation = Quaternion(0.338738, 1.88075e-08, 1.8609e-07, 0.940881)
bones/20/rotation = Quaternion(0.109925, -0.294562, -0.531843, 0.786316)
bones/20/scale = Vector3(1, 1, 1)
bones/21/position = Vector3(-0.0860748, 0.118223, 2.45931)
bones/21/rotation = Quaternion(0.0627909, 7.09205e-08, 9.145e-08, 0.998027)
bones/22/position = Vector3(-0.00477219, 0.0173302, 1.9162)
bones/22/rotation = Quaternion(0.460975, 2.11995e-07, -6.29719e-09, 0.887413)
bones/22/scale = Vector3(1, 1, 1)
bones/23/position = Vector3(-5.01147, -3.45796, 10.3695)
bones/23/rotation = Quaternion(-0.231689, -0.018064, 0.969545, -0.0773061)
bones/24/position = Vector3(-8.01086e-05, -1.79234, -0.483702)
bones/24/rotation = Quaternion(0.140901, 1.05619e-06, -6.73885e-07, 0.990024)
bones/25/position = Vector3(-2.28882e-05, 6.12096, -0.17386)
bones/25/rotation = Quaternion(-0.140901, 3.03233e-08, 1.60772e-08, 0.990024)
bones/25/scale = Vector3(0.999993, 0.999996, 0.999996)
bones/26/position = Vector3(-7.05719e-05, 5.49174, 2.94321)
bones/27/position = Vector3(-3.8147e-06, -1.95837, -5.78759)
bones/27/rotation = Quaternion(-0.368125, -7.86855e-08, -4.71696e-08, 0.929777)
bones/28/position = Vector3(11.8042, -2.40156, -3.50822)
bones/29/position = Vector3(1.16787, -4.66491, 9.04447)
bones/29/rotation = Quaternion(0.454744, 0.839416, 0.0942909, 0.28231)
bones/30/position = Vector3(0.0967197, -0.206528, 19.4601)
bones/30/rotation = Quaternion(0.31296, 0.21739, 0.222023, 0.897498)
bones/31/position = Vector3(-1.05586, -0.409813, 21.6019)
bones/31/rotation = Quaternion(-0.0363135, -0.197571, -0.517059, 0.832044)
bones/32/position = Vector3(2.87481, -2.17789, 4.46067)
bones/32/rotation = Quaternion(0.403649, 0.122101, 0.793849, 0.438136)
bones/32/scale = Vector3(0.99999, 0.99999, 1)
bones/33/position = Vector3(-0.906168, 0.911577, 2.05271)
bones/33/rotation = Quaternion(-0.00764955, -0.225794, 0.00177339, 0.974143)
bones/34/position = Vector3(0.709144, -0.130932, 4.48517)
bones/34/rotation = Quaternion(-0.00783036, 0.0784567, -0.000617211, 0.996887)
bones/35/position = Vector3(1.7753, -2.66099, 11.3457)
bones/35/rotation = Quaternion(0.298575, 0.320285, 0.732266, 0.521591)
bones/35/scale = Vector3(0.99999, 0.99999, 1)
bones/36/position = Vector3(-0.251375, 0.105277, 3.98449)
bones/36/rotation = Quaternion(0.217713, 0.00674663, -0.0032666, 0.975984)
bones/37/position = Vector3(0.0447044, 0.0614319, 3.08161)
bones/37/rotation = Quaternion(0.333923, 0.0103991, -0.00270404, 0.942539)
bones/37/scale = Vector3(1, 1, 1)
bones/38/position = Vector3(1.38163, -0.292988, 10.584)
bones/38/rotation = Quaternion(0.294083, 0.335312, 0.653041, 0.612061)
bones/38/scale = Vector3(0.999994, 0.999995, 1)
bones/39/position = Vector3(-0.000226974, 0.186819, 3.93567)
bones/39/rotation = Quaternion(0.290897, 8.07938e-07, 4.59454e-07, 0.956755)
bones/39/scale = Vector3(1, 1, 1)
bones/40/position = Vector3(0.0430202, 0.0579681, 3.67391)
bones/40/rotation = Quaternion(0.290895, 1.07854e-06, -2.84626e-06, 0.956755)
bones/41/position = Vector3(1.64947, 2.30479, 9.36617)
bones/41/rotation = Quaternion(0.224835, 0.342867, 0.596952, 0.689594)
bones/41/scale = Vector3(0.99999, 0.99999, 1)
bones/42/position = Vector3(0.0611706, -0.043529, 3.93942)
bones/42/rotation = Quaternion(0.335646, 4.97499e-06, -1.34459e-06, 0.941988)
bones/43/position = Vector3(-0.122782, 0.0801525, 3.11917)
bones/43/rotation = Quaternion(0.290889, -4.94497e-07, 3.84695e-06, 0.956757)
bones/44/position = Vector3(2.63009, 4.52658, 8.52431)
bones/44/rotation = Quaternion(0.261216, 0.392659, 0.464157, 0.749763)
bones/45/position = Vector3(0.0860796, 0.118217, 2.45932)
bones/45/rotation = Quaternion(0.218147, 1.19879e-06, -1.71774e-07, 0.975916)
bones/46/position = Vector3(0.00478363, 0.0173244, 1.91619)
bones/46/rotation = Quaternion(0.195088, 8.36203e-07, -1.99789e-06, 0.980786)
bones/46/scale = Vector3(1, 0.999998, 1.00001)
bones/47/position = Vector3(-0.591662, -0.22963, 12.1049)
bones/47/rotation = Quaternion(-2.20129e-06, 1.15206e-06, -0.481756, 0.876306)

[node name="Object_7" parent="Camera/Player/Sketchfab_model/e430f8f941c64cbea96a18e2036f08b4_fbx/Object_2/RootNode/Object_4/Skeleton3D" index="0"]
layers = 512
cast_shadow = 0

[node name="Object_9" parent="Camera/Player/Sketchfab_model/e430f8f941c64cbea96a18e2036f08b4_fbx/Object_2/RootNode/Object_4/Skeleton3D" index="1"]
layers = 512
cast_shadow = 0

[node name="Object_11" parent="Camera/Player/Sketchfab_model/e430f8f941c64cbea96a18e2036f08b4_fbx/Object_2/RootNode/Object_4/Skeleton3D" index="2"]
layers = 512
cast_shadow = 0

[node name="Object_13" parent="Camera/Player/Sketchfab_model/e430f8f941c64cbea96a18e2036f08b4_fbx/Object_2/RootNode/Object_4/Skeleton3D" index="3"]
layers = 512
cast_shadow = 0

[node name="Object_15" parent="Camera/Player/Sketchfab_model/e430f8f941c64cbea96a18e2036f08b4_fbx/Object_2/RootNode/Object_4/Skeleton3D" index="4"]
layers = 512
cast_shadow = 0

[node name="Object_17" parent="Camera/Player/Sketchfab_model/e430f8f941c64cbea96a18e2036f08b4_fbx/Object_2/RootNode/Object_4/Skeleton3D" index="5"]
layers = 512
cast_shadow = 0

[node name="Object_19" parent="Camera/Player/Sketchfab_model/e430f8f941c64cbea96a18e2036f08b4_fbx/Object_2/RootNode/Object_4/Skeleton3D" index="6"]
layers = 512
cast_shadow = 0

[node name="AnimationTree" type="AnimationTree" parent="Camera/Player"]
tree_root = SubResource("AnimationNodeStateMachine_f4gc3")
anim_player = NodePath("../AnimationPlayer")
parameters/conditions/reload = false
parameters/conditions/shoot = false

[node name="MuzzleFlash" type="OmniLight3D" parent="Camera"]
transform = Transform3D(1, -4.00166e-17, -5.68434e-14, -4.00166e-17, 1, 1.94289e-16, 6.39488e-14, -2.498e-16, 1, 0.302192, -0.066237, -1.06763)
visible = false
light_color = Color(1, 0.462745, 0, 1)
light_energy = 3.0
light_size = 0.06
light_specular = 9.044
light_cull_mask = 4294966784
omni_range = 2.0

[node name="CShape" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.9, 0)
shape = SubResource("CapsuleShape3D_3rsb5")

[node name="GUI" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="Postprocesing" type="ColorRect" parent="GUI"]
material = SubResource("ShaderMaterial_cv6qa")
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="CenterContainer" type="CenterContainer" parent="GUI" node_paths=PackedStringArray("RETICLE_LINES", "PLAYER_CONTROLLER")]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("4_rvq42")
RETICLE_LINES = [NodePath("Top"), NodePath("Right"), NodePath("Bottom"), NodePath("Left")]
PLAYER_CONTROLLER = NodePath("../..")
RETICLE_DISTANCE = 1.0
HITMARKER_COLOR = Color(1, 1, 1, 1)

[node name="Top" type="Line2D" parent="GUI/CenterContainer"]
points = PackedVector2Array(0, -5, 0, -15)
width = 2.0

[node name="Right" type="Line2D" parent="GUI/CenterContainer"]
points = PackedVector2Array(5, 0, 15, 0)
width = 2.0

[node name="Bottom" type="Line2D" parent="GUI/CenterContainer"]
points = PackedVector2Array(0, 5, 0, 15)
width = 2.0

[node name="Left" type="Line2D" parent="GUI/CenterContainer"]
points = PackedVector2Array(-5, 0, -15, 0)
width = 2.0

[node name="HUDContainer" type="Control" parent="GUI"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="BottomHUDContainer" type="HBoxContainer" parent="GUI/HUDContainer"]
layout_mode = 1
anchors_preset = 12
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 20.0
offset_top = -45.0
offset_right = -20.0
offset_bottom = -20.0
grow_horizontal = 2
grow_vertical = 0

[node name="LeftElements" type="VBoxContainer" parent="GUI/HUDContainer/BottomHUDContainer"]
layout_mode = 2
theme_override_constants/separation = 5
alignment = 1

[node name="HealthBar" type="ProgressBar" parent="GUI/HUDContainer/BottomHUDContainer/LeftElements"]
custom_minimum_size = Vector2(200, 20)
layout_mode = 2
value = 100.0
show_percentage = false

[node name="HealthText" type="Label" parent="GUI/HUDContainer/BottomHUDContainer/LeftElements/HealthBar"]
layout_mode = 1
anchors_preset = 4
anchor_top = 0.5
anchor_bottom = 0.5
offset_left = 10.0
grow_vertical = 2
text = "100"
vertical_alignment = 1

[node name="DashBar" type="ProgressBar" parent="GUI/HUDContainer/BottomHUDContainer/LeftElements"]
visible = false
custom_minimum_size = Vector2(200, 10)
layout_mode = 2
value = 100.0
show_percentage = false

[node name="DashBarDouble" type="HBoxContainer" parent="GUI/HUDContainer/BottomHUDContainer/LeftElements"]
layout_mode = 2
theme_override_constants/separation = 2

[node name="DashBar1" type="ProgressBar" parent="GUI/HUDContainer/BottomHUDContainer/LeftElements/DashBarDouble"]
custom_minimum_size = Vector2(99, 10)
layout_mode = 2
value = 100.0
show_percentage = false

[node name="DashBar2" type="ProgressBar" parent="GUI/HUDContainer/BottomHUDContainer/LeftElements/DashBarDouble"]
custom_minimum_size = Vector2(99, 10)
layout_mode = 2
value = 100.0
show_percentage = false

[node name="RightElements" type="HBoxContainer" parent="GUI/HUDContainer/BottomHUDContainer"]
layout_mode = 2
size_flags_horizontal = 10
size_flags_vertical = 8
theme_override_constants/separation = 0

[node name="CurrentAmmo" type="Label" parent="GUI/HUDContainer/BottomHUDContainer/RightElements"]
layout_mode = 2
size_flags_vertical = 1
theme_override_font_sizes/font_size = 48
text = "30"
vertical_alignment = 1

[node name="MaxAmmo" type="Label" parent="GUI/HUDContainer/BottomHUDContainer/RightElements"]
layout_mode = 2
size_flags_vertical = 1
theme_override_font_sizes/font_size = 22
text = "/30"
vertical_alignment = 1

[node name="DeathScreenContainer" type="Control" parent="GUI"]
visible = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="BlackScreen" type="ColorRect" parent="GUI/DeathScreenContainer"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.490196)

[node name="Text" type="Label" parent="GUI/DeathScreenContainer/BlackScreen"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -20.0
offset_top = -11.5
offset_right = 20.0
offset_bottom = 11.5
grow_horizontal = 2
grow_vertical = 2
theme_override_font_sizes/font_size = 76
text = "Has muerto primo
[R] para reiniciar"
horizontal_alignment = 1

[node name="FloorCheck" type="RayCast3D" parent="."]
collision_mask = 7
collide_with_areas = true

[editable path="Camera/Player"]
